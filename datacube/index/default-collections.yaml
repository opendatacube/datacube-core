eo:
    description: |
        Earth Observation datasets.

        Default collection accepting datasets produced by the eodatasets library.
        (or of similar structure)

        https://github.com/GeoscienceAustralia/eo-datasets

    # What datasets should we include in this collection?
    match:
        # Match datasets by their metadata fields.
        #
        # If this is a subset of the dataset's metadata, it's a match.
        #
        # Match all datasets (no properties specified)
        metadata: {}
        # Low match priority because it's the default.
        priority: 999

    dataset:
        # Where to find certain fields in dataset objects:

        # UUID: Unique for this exact dataset. Reprocessed datasets have new UUIDs.
        id_offset: ['id']

        # datetime the dataset was processed/created.
        # This is used to know which is the latest dataset (when multiple versions exist).
        creation_dt_offset: ['creation_dt']

        # The dataset "label" is the logical identifier for a dataset.
        #
        # -> Multiple datasets may arrive with the same label, but only the 'latest' will be returned by default
        #    in searches.
        #
        # Use case: reprocessing a dataset.
        # -> When reprocessing a dataset, the new dataset should be produced with the same label as the old one.
        # -> Because you probably don't want both datasets returned from typical searches. (they are the same data)
        # -> When ingested, this reprocessed dataset will be the only one visible to typical searchers.
        # -> But the old dataset will still exist in the database for provenance & historical record.
        #       -> Existing higher-level/derived datasets will still link to the old dataset they were processed
        #          from, even if it's not the latest.
        #
        # An example label used by GA (called "dataset_ids" on historical systems):
        #      -> Eg. "LS7_ETM_SYS_P31_GALPGS01-002_114_73_20050107"
        #
        # But the collection owner can use any string to label their datasets.
        label_offset: ['ga_label']

        # Where to find a dict of measurements/bands in the dataset.
        #  -> Dict key is measurement/band id,
        #  -> Dict value is object with fields depending on the storage driver.
        #     (such as path to band file, offset within file etc.)
        measurements_offset: ['image', 'bands']

        # Fields that we want indexed and searchable in the documents.
        # (the keys/names are arbitrary, but are specified by users when searching)
        search_fields:
            # When no 'type' is specified, it defaults to String.
            satellite:
                offset: [platform, code]
            sensor:
                offset: [instrument, name]
            product:
                offset: [product_type]

            lat:
                type: float-range
                max_offset:
                - [extent, coord, ur, lat]
                - [extent, coord, lr, lat]
                min_offset:
                - [extent, coord, ul, lat]
                - [extent, coord, ll, lat]
            lon:
                type: float-range
                max_offset:
                - [extent, coord, ul, lon]
                - [extent, coord, ur, lon]
                min_offset:
                - [extent, coord, ll, lon]
                - [extent, coord, lr, lon]
            # Acquisition time.
    #        time:
    #            type: datetime-range
    #            min_offset:
    #            - [extent, from_dt]
    #            max_offset:
    #            - [extent, to_dt]

            # Ground Station Identifier (eg. 'ASA')
            gsi:
                offset: [acquisition, groundstation, code]
            orbit:
                offset: [acquisition, platform_orbit]

            # Path/row (specific to Landsat).
            sat_path:
                type: float-range
                min_offset:
                - [image, satellite_ref_point_start, x]
                max_offset:
                - [image, satellite_ref_point_end, x]
                # If an end is not specified, use the start.
                - [image, satellite_ref_point_start, x]
            sat_row:
                type: float-range
                min_offset:
                - [image, satellite_ref_point_start, y]
                max_offset:
                - [image, satellite_ref_point_end, y]
                # If an end is not specified, use the start.
                - [image, satellite_ref_point_start, y]

    storage_unit:
        # Fields that we want indexed and searchable in the documents.
        # (the keys/names are arbitrary, but are specified by users when searching)
        search_fields:
    #        time:
    #            type: datetime-range
    #            min_offset:
    #            - [extents, time_min]
    #            max_offset:
    #            - [extents, time_max]
            lat:
                type: float-range
                min_offset:
                - [extents, geospatial_lat_min]
                max_offset:
                - [extents, geospatial_lat_max]
            lon:
                type: float-range
                min_offset:
                - [extents, geospatial_lon_min]
                max_offset:
                - [extents, geospatial_lon_max]
