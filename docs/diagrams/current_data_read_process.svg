<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="883px" preserveAspectRatio="none" style="width:1166px;height:883px;" version="1.1" viewBox="0 0 1166 883" width="1166px" zoomAndPan="magnify"><defs><filter height="300%" id="fujuhxctdv98e" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="265" x="451.5" y="22.9951">Current Process for Loading Data</text><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="639.5234" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="312" y="147.7266"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="593.5234" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="317" y="184.7266"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="484.125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="322" y="250.9922"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="348.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="327" y="365.5234"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="322.7617" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="488" y="412.3555"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="210.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="692.5" y="488.1875"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="165.5" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="947.5" y="533.4844"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="545.2578" style="stroke: #000000; stroke-width: 2.0;" width="1030" x="125" y="204.8594"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="423.7266" style="stroke: #000000; stroke-width: 2.0;" width="880.5" x="264.5" y="319.3906"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="267.0625" style="stroke: #000000; stroke-width: 2.0;" width="700.5" x="434.5" y="439.9219"/><rect fill="#98FB98" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="648" y="457.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="655" y="477.0498">DataSource</text><rect fill="#00FFFF" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="901" y="502.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="908" y="522.3467">BandSource</text><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="116.2031" style="stroke: #000000; stroke-width: 2.0;" width="234" x="891" y="554.6484"/><rect fill="#FFFFFF" height="56.9375" style="stroke: none; stroke-width: 1.0;" width="234" x="891" y="613.9141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="27" x2="27" y1="116.5938" y2="796.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="316.5" x2="316.5" y1="116.5938" y2="796.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="492.5" x2="492.5" y1="116.5938" y2="796.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="697" x2="697" y1="489.7031" y2="796.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="952" x2="952" y1="535" y2="796.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="113.292">User</text><ellipse cx="27" cy="43.2969" fill="#FEFECE" filter="url(#fujuhxctdv98e)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,51.2969 L27,78.2969 M14,59.2969 L40,59.2969 M27,78.2969 L14,93.2969 M27,78.2969 L40,93.2969 " fill="none" filter="url(#fujuhxctdv98e)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="808.2451">User</text><ellipse cx="27" cy="821.5469" fill="#FEFECE" filter="url(#fujuhxctdv98e)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,829.5469 L27,856.5469 M14,837.5469 L40,837.5469 M27,856.5469 L14,871.5469 M27,856.5469 L40,871.5469 " fill="none" filter="url(#fujuhxctdv98e)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="274.5" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="281.5" y="101.292">Datacube</text><rect fill="#FEFECE" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="274.5" y="795.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="281.5" y="815.2451">Datacube</text><rect fill="#FEFECE" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="444.5" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="451.5" y="101.292">DataLoader</text><rect fill="#FEFECE" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="444.5" y="795.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="451.5" y="815.2451">DataLoader</text><rect fill="#98FB98" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="648" y="795.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="655" y="815.2451">DataSource</text><rect fill="#00FFFF" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="901" y="795.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="908" y="815.2451">BandSource</text><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="639.5234" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="312" y="147.7266"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="593.5234" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="317" y="184.7266"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="484.125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="322" y="250.9922"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="348.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="327" y="365.5234"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="322.7617" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="488" y="412.3555"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="210.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="692.5" y="488.1875"/><rect fill="#FFFFFF" filter="url(#fujuhxctdv98e)" height="165.5" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="947.5" y="533.4844"/><polygon fill="#A80036" points="300,143.7266,310,147.7266,300,151.7266,304,147.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="27" x2="306" y1="147.7266" y2="147.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="34" y="142.6606">Requests some data using dc.load_data()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="322" x2="369" y1="171.8594" y2="171.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="369" x2="369" y1="171.8594" y2="184.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="328" x2="369" y1="184.8594" y2="184.8594"/><polygon fill="#A80036" points="338,180.8594,328,184.8594,338,188.8594,334,184.8594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="334" y="166.7935">create_storage()</text><path d="M125,204.8594 L202,204.8594 L202,211.8594 L192,221.8594 L125,221.8594 L125,204.8594 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="545.2578" style="stroke: #000000; stroke-width: 2.0;" width="1030" x="125" y="204.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="140" y="217.9263">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="190" x="217" y="217.0698">[for each measurement/band]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="327" x2="374" y1="238.125" y2="238.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="374" x2="374" y1="238.125" y2="251.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333" x2="374" y1="251.125" y2="251.125"/><polygon fill="#A80036" points="343,247.125,333,251.125,343,255.125,339,251.125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="339" y="233.0591">data_func()</text><polygon fill="#FBFB77" filter="url(#fujuhxctdv98e)" points="145,269.125,489,269.125,499,288.125,489,307.125,145,307.125,135,288.125,145,269.125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="147" y="285.1919">create a destination array in RAM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="340" x="147" y="300.3247">Dimensions are &lt;irregular dims&gt; + &lt;geobox_dims&gt;</text><path d="M264.5,319.3906 L341.5,319.3906 L341.5,326.3906 L331.5,336.3906 L264.5,336.3906 L264.5,319.3906 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="423.7266" style="stroke: #000000; stroke-width: 2.0;" width="880.5" x="264.5" y="319.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="279.5" y="332.4575">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="356.5" y="331.6011">[for each time slice]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="379" y1="352.6563" y2="352.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379" x2="379" y1="352.6563" y2="365.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338" x2="379" y1="365.6563" y2="365.6563"/><polygon fill="#A80036" points="348,361.6563,338,365.6563,348,369.6563,344,365.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="344" y="347.5903">_fuse_measurement()</text><polygon fill="#A80036" points="476,408.3555,486,412.3555,476,416.3555,480,412.3555" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337" x2="482" y1="412.3555" y2="412.3555"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="344" y="407.2896">reproject_and_fuse()</text><path d="M503,383.6563 L503,423.6563 L870,423.6563 L870,393.6563 L860,383.6563 L503,383.6563 " fill="#FBFB77" filter="url(#fujuhxctdv98e)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M860,383.6563 L860,393.6563 L870,393.6563 L860,383.6563 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="509" y="400.7231">DataLoader is not currently a class, it is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="509" y="415.856">functions in the</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="611" y="415.856">datacube.storage.storage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="807" y="415.856">module</text><path d="M434.5,439.9219 L511.5,439.9219 L511.5,446.9219 L501.5,456.9219 L434.5,456.9219 L434.5,439.9219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="267.0625" style="stroke: #000000; stroke-width: 2.0;" width="700.5" x="434.5" y="439.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="449.5" y="452.9888">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="141" x="526.5" y="452.1323">[for each DataSource]</text><polygon fill="#A80036" points="636,474.1875,646,478.1875,636,482.1875,640,478.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="498" x2="642" y1="478.1875" y2="478.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="505" y="473.1216">read_from_source()</text><rect fill="#98FB98" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="648" y="457.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="655" y="477.0498">DataSource</text><polygon fill="#A80036" points="889,519.4844,899,523.4844,889,527.4844,893,523.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="702.5" x2="895" y1="523.4844" y2="523.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="709.5" y="518.4185">open() returns BandSource</text><rect fill="#00FFFF" filter="url(#fujuhxctdv98e)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="901" y="502.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="908" y="522.3467">BandSource</text><path d="M891,554.6484 L955,554.6484 L955,561.6484 L945,571.6484 L891,571.6484 L891,554.6484 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="116.2031" style="stroke: #000000; stroke-width: 2.0;" width="234" x="891" y="554.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="906" y="567.7153">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="970" y="566.8589">[Non reprojecting read]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="957.5" x2="999.5" y1="592.9141" y2="592.9141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="999.5" x2="999.5" y1="592.9141" y2="605.9141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="958.5" x2="999.5" y1="605.9141" y2="605.9141"/><polygon fill="#A80036" points="968.5,601.9141,958.5,605.9141,968.5,609.9141,964.5,605.9141" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="964.5" y="587.8481">_read_native()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="891" x2="1125" y1="614.9141" y2="614.9141"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="896" y="625.1245">[ReProjecting read]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="957.5" x2="999.5" y1="649.8516" y2="649.8516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="999.5" x2="999.5" y1="649.8516" y2="662.8516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="958.5" x2="999.5" y1="662.8516" y2="662.8516"/><polygon fill="#A80036" points="968.5,658.8516,958.5,662.8516,968.5,666.8516,964.5,662.8516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="964.5" y="644.7856">reproject()</text><polygon fill="#A80036" points="708.5,694.9844,698.5,698.9844,708.5,702.9844,704.5,698.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="702.5" x2="951.5" y1="698.9844" y2="698.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="714.5" y="693.9185">append data into destination array</text><polygon fill="#A80036" points="338,731.1172,328,735.1172,338,739.1172,334,735.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332" x2="492" y1="735.1172" y2="735.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="344" y="730.0513">return data</text><polygon fill="#A80036" points="38,774.25,28,778.25,38,782.25,34,778.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="32" x2="311" y1="778.25" y2="778.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="44" y="773.1841">return data</text><!--
@startuml

title Current Process for Loading Data

actor User

participant Datacube


User -> Datacube: Requests some data using dc.load_data()
activate Datacube

Datacube -> Datacube: create_storage()
activate Datacube
loop for each measurement/band
  Datacube -> Datacube: data_func()
  activate Datacube
  hnote over Datacube
    create a destination array in RAM
    Dimensions are <irregular dims> + <geobox_dims>
  end note
  loop for each time slice
    Datacube -> Datacube: _fuse_measurement()
    activate Datacube
    Datacube -> DataLoader:  reproject_and_fuse()
    note right
        DataLoader is not currently a class, it is 
        functions in the ""datacube.storage.storage"" module
    end note
    activate DataLoader
    participant DataSource #PaleGreen
    loop for each DataSource
        create DataSource
        DataLoader -> DataSource: read_from_source()
        activate DataSource

        participant BandSource #Cyan
        create BandSource
        DataSource -> BandSource: open() returns BandSource
        activate BandSource
        alt Non reprojecting read
            BandSource -> BandSource: _read_native()
        else ReProjecting read
            BandSource -> BandSource: reproject()
        end
        BandSource - -> DataSource: append data into destination array
        deactivate BandSource
        deactivate DataSource
    end
    deactivate Datacube
    DataLoader - -> Datacube: return data
    deactivate DataLoader

    deactivate Datacube
  end
end

Datacube - -> User: return data
deactivate Datacube


@enduml

PlantUML version 1.2018.13(Tue Nov 27 04:11:51 AEDT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-post-Ubuntu-3ubuntu1
Operating System: Linux
OS Version: 5.4.0-1012-azure
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>
